include:
  - local: function/notifications/pushover/repo-ci-pipeline.yml
  - local: function/docker/default.yml

.generate-function-doc:
  image: donaldrich/private:docker-runner
  variables:
    GIT_STRATEGY: none
  retry: 2
  stage: test
  script:
    - docker pull donaldrich/function:$IMAGE_TAG
    - docker run --rm donaldrich/function:$IMAGE_TAG
    - docker run --rm donaldrich/function:$IMAGE_TAG > $CI_PROJECT_DIR/snippets/$IMAGE_TAG.md
    - curl https://api.github.com/repos/$REPO_URL | jq ".description" > $CI_PROJECT_DIR/snippets/$IMAGE_TAG-description.md || true
  # artifacts:
  #   untracked: true
  #   paths:
  #     - doc-test/
  #   when: always
  # cache:
  #   untracked: true
  #   paths:
  #     - doc-test/
