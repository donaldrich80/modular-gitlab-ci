include:
  - local: function/notifications/pushover/repo-ci-pipeline.yml
  - local: function/docker/default.yml

.generate-function-doc:
  image: donaldrich/private:docker-runner:latest
  variables:
    GIT_STRATEGY: none
  retry: 2
  stage: test
  script:
    - apk add curl jq
    - docker pull donaldrich/function:$IMAGE_TAG
    - docker run --rm donaldrich/function:$IMAGE_TAG
    - docker run --rm donaldrich/function:$IMAGE_TAG > $CI_PROJECT_DIR/snippets/$IMAGE_TAG.md
    - docker run --rm donaldrich/function:$IMAGE_TAG $VERSION_COMMAND > $CI_PROJECT_DIR/snippets/$IMAGE_TAG-version.md
    - curl https://api.github.com/repos/$REPO_URL > $CI_PROJECT_DIR/snippets/$IMAGE_TAG-github-info.md || true

    # cat my_file.txt | xargs echo
    
    
    # - curl https://api.github.com/repos/$REPO_URL | jq ".description" > $CI_PROJECT_DIR/snippets/$IMAGE_TAG-description.md || true

.generate-function-description:
  image: donaldrich/ubuntu-runner:latest
  variables:
    GIT_STRATEGY: none
  retry: 2
  stage: test
  script:
    - curl https://api.github.com/repos/$REPO_URL | jq ".description" > $CI_PROJECT_DIR/snippets/$IMAGE_TAG-github-info.md || true
