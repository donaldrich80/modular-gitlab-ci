ansible:
  extends: .ansible-runner
  stage: lint
  script:
    - ansible-lint -x 204 -x 702 playbooks/*.yml
  allow_failure: true
  interruptible: true
  when: on_success

# ansible-lint --force-color -p -v

# ansible-lint:
#   stage: lint
#   allow_failure: true
#   interruptible: true
#   # image: sdesbure/ansible-lint
#   image: donaldrich/ansible
#   script:
#     - ansible-lint playbooks/*.yml
  # rules:
  #   - if: '$DEBUG_PIPELINE'
  #     when: never
  #   - changes:
  #     - "**/playbooks/*.yml"
  #     when: always
  #   - exists:
  #     - "**/playbooks/*.yml"
  #     when: manual
  #   - when: never